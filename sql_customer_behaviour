средний чек по способу платежа
```sql
WITH full_product_price AS (
    SELECT 
        price * quantity AS full_price,
        customer_id,
        order_date, 
        product_id, 
        payment_method
    FROM retail_data),

full_cheque_price AS (
    SELECT 
        SUM(full_price) AS cheque_price,
        customer_id,
        order_date, 
        payment_method
    FROM full_product_price
    GROUP BY 
        customer_id, 
        order_date, 
        payment_method)

SELECT 
    payment_method,
    ROUND(AVG(cheque_price), 2) AS avg_cheque_price
FROM full_cheque_price
GROUP BY payment_method
ORDER BY avg_cheque_price DESC
```



средний чек по городу--------------------
WITH full_product_price AS (
    SELECT 
        price * quantity AS full_price,
        customer_id,
        order_date, 
        product_id, 
        city
    FROM retail_data),

full_cheque_price AS (
    SELECT 
        SUM(full_price) AS cheque_price,
        customer_id,
        order_date, 
        city
    FROM full_product_price
    GROUP BY 
        customer_id, 
        order_date, 
        city)

SELECT 
    city,
    ROUND(AVG(cheque_price), 2) AS avg_cheque_price
FROM full_cheque_price
GROUP BY city
ORDER BY avg_cheque_price DESC






